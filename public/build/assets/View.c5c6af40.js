import{g as z,i as b,u as H,C as U,j as q,k as j,l as W,r as i,o as u,c as w,t as p,b as o,w as r,y as t,x as f,s as v,F as J,H as X,v as S,z as K,A as I,am as Q,a5 as Y,D as Z}from"./vendor.e9042f2c.js";import{g as ee,B as A,u as te,d as P,i as M,e as R}from"./main.d8ec3f25.js";import{L as ne}from"./LoadingIcon.1d7d9f05.js";import{_ as ae}from"./InvoiceIndexDropdown.c26f9f0a.js";import{_ as oe}from"./RecurringInvoiceIndexDropdown.7160d2ee.js";const re={class:"fixed top-0 left-0 hidden h-full pt-16 pb-4 ml-56 bg-white xl:ml-64 w-88 xl:block"},se={class:"flex items-center justify-between px-4 pt-8 pb-2 border border-gray-200 border-solid height-full"},ie={class:"mb-6"},le={class:"flex mb-6 ml-3",role:"group","aria-label":"First group"},ce={class:"px-2 py-1 pb-2 mb-1 mb-2 text-sm border-b border-gray-200 border-solid"},ue={key:0,class:"h-full pb-32 overflow-y-scroll border-l border-gray-200 border-solid base-scroll"},de={class:"flex-2"},me={class:"pr-2 mb-2 text-sm not-italic font-normal leading-5 text-black capitalize truncate"},_e={class:"mt-1 mb-2 text-xs not-italic font-medium leading-5 text-gray-600"},ge={class:"flex-1 whitespace-nowrap right"},ve={class:"text-sm not-italic font-normal leading-5 text-right text-gray-600 est-date"},pe={class:"flex justify-center p-4 items-center"},fe={key:0,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},ye={setup(O){ee();const n=A();te(),P(),M(),z(),b(null),b(null),b(null);const d=H();U(),b(["DRAFT","SENT","VIEWED","EXPIRED","ACCEPTED","REJECTED"]);const l=b(!1),m=b(!1),e=q({orderBy:null,orderByField:null,searchText:null}),B=j(()=>e.orderBy==="asc"||e.orderBy==null);function h(s){return d.params.id==s}async function _(){m.value=!0,await n.fetchRecurringInvoices(),m.value=!1,setTimeout(()=>{E()},500)}function E(){const s=document.getElementById(`recurring-invoice-${d.params.id}`);s&&(s.scrollIntoView({behavior:"smooth"}),s.classList.add("shake"))}async function g(){let s="";e.searchText!==""&&e.searchText!==null&&e.searchText!==void 0&&(s+=`search=${e.searchText}&`),e.orderBy!==null&&e.orderBy!==void 0&&(s+=`orderBy=${e.orderBy}&`),e.orderByField!==null&&e.orderByField!==void 0&&(s+=`orderByField=${e.orderByField}`),l.value=!0;let a=await n.searchRecurringInvoice(s);l.value=!1,a.data&&(n.recurringInvoices=a.data.data)}function x(){return e.orderBy==="asc"?(e.orderBy="desc",g(),!0):(e.orderBy="asc",g(),!0)}return _(),g=W.exports.debounce(g,500),(s,a)=>{const y=i("BaseIcon"),V=i("BaseInput"),k=i("BaseButton"),D=i("BaseRadio"),$=i("BaseInputGroup"),C=i("BaseDropdownItem"),F=i("BaseDropdown"),T=i("BaseRecurringInvoiceStatusBadge"),N=i("BaseFormatMoney"),L=i("router-link");return u(),w("div",re,[p("div",se,[p("div",ie,[o(V,{modelValue:t(e).searchText,"onUpdate:modelValue":a[0]||(a[0]=c=>t(e).searchText=c),placeholder:s.$t("general.search"),type:"text",variant:"gray",onInput:a[1]||(a[1]=c=>g())},{right:r(()=>[o(y,{name:"SearchIcon",class:"h-5 text-gray-400"})]),_:1},8,["modelValue","placeholder"])]),p("div",le,[o(F,{class:"ml-3",position:"bottom-start"},{activator:r(()=>[o(k,{size:"md",variant:"gray"},{default:r(()=>[o(y,{name:"FilterIcon",class:"h-5"})]),_:1})]),default:r(()=>[p("div",ce,f(s.$t("general.sort_by")),1),o(C,{class:"flex px-1 py-2 cursor-pointer"},{default:r(()=>[o($,{class:"-mt-3 font-normal"},{default:r(()=>[o(D,{id:"filter_next_invoice_date",modelValue:t(e).orderByField,"onUpdate:modelValue":[a[2]||(a[2]=c=>t(e).orderByField=c),g],label:s.$t("recurring_invoices.next_invoice_date"),size:"sm",name:"filter",value:"next_invoice_at"},null,8,["modelValue","label"])]),_:1})]),_:1}),o(C,{class:"flex px-1 py-2 cursor-pointer"},{default:r(()=>[o($,{class:"-mt-3 font-normal"},{default:r(()=>[o(D,{id:"filter_start_date",modelValue:t(e).orderByField,"onUpdate:modelValue":[a[3]||(a[3]=c=>t(e).orderByField=c),g],label:s.$t("recurring_invoices.starts_at"),value:"starts_at",size:"sm",name:"filter"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),o(k,{class:"ml-1",size:"md",variant:"gray",onClick:x},{default:r(()=>[t(B)?(u(),v(y,{key:0,name:"SortAscendingIcon",class:"h-5"})):(u(),v(y,{key:1,name:"SortDescendingIcon",class:"h-5"}))]),_:1})])]),t(n)&&t(n).recurringInvoices?(u(),w("div",ue,[(u(!0),w(J,null,X(t(n).recurringInvoices,(c,G)=>(u(),w("div",{key:G},[c&&!m.value?(u(),v(L,{key:0,id:"recurring-invoice-"+c.id,to:`/admin/recurring-invoices/${c.id}/view`,class:K(["flex justify-between side-invoice p-4 cursor-pointer hover:bg-gray-100 items-center border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":h(c.id)}]),style:{"border-bottom":"1px solid rgba(185, 193, 209, 0.41)"}},{default:r(()=>[p("div",de,[p("div",me,f(c.customer.name),1),p("div",_e,f(c.invoice_number),1),o(T,{status:c.status,class:"px-1 text-xs"},{default:r(()=>[S(f(c.status),1)]),_:2},1032,["status"])]),p("div",ge,[o(N,{class:"block mb-2 text-xl not-italic font-semibold leading-8 text-right text-gray-900",amount:c.total,currency:c.customer.currency},null,8,["amount","currency"]),p("div",ve,f(c.formatted_starts_at),1)])]),_:2},1032,["id","to","class"])):I("",!0)]))),128)),p("div",pe,[m.value?(u(),v(ne,{key:0,class:"h-6 m-1 animate-spin text-primary-400"})):I("",!0)]),!t(n).recurringInvoices.length&&!m.value?(u(),w("p",fe,f(s.$t("invoices.no_matching_invoices")),1)):I("",!0)])):I("",!0)])}}},be={class:"relative table-container"},Ie={setup(O){const n=A(),d=b(null);b(null),Q("$utils");const{t:l}=z();b(null),U();const m=P(),e=j(()=>[{key:"invoice_date",label:l("invoices.date"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"invoice_number",label:l("invoices.invoice")},{key:"customer.name",label:l("invoices.customer")},{key:"status",label:l("invoices.status")},{key:"total",label:l("invoices.total")},{key:"actions",label:l("invoices.action"),tdClass:"text-right text-sm font-medium",thClass:"text-right",sortable:!1}]);function B(){return m.hasAbilities([R.DELETE_INVOICE,R.EDIT_INVOICE,R.VIEW_INVOICE,R.SEND_INVOICE])}return(h,_)=>{const E=i("router-link"),g=i("BaseFormatMoney"),x=i("BaseInvoiceStatusBadge"),s=i("BaseTable");return u(),w("div",be,[o(s,{ref:(a,y)=>{y.table=a,d.value=a},data:t(n).newRecurringInvoice.invoices,columns:t(e),loading:t(n).isFetchingViewData,"placeholder-count":5,class:"mt-5"},Y({"cell-invoice_number":r(({row:a})=>[o(E,{to:{path:`/admin/invoices/${a.data.id}/view`},class:"font-medium text-primary-500"},{default:r(()=>[S(f(a.data.invoice_number),1)]),_:2},1032,["to"])]),"cell-total":r(({row:a})=>[o(g,{amount:a.data.due_amount,currency:a.data.currency},null,8,["amount","currency"])]),"cell-status":r(({row:a})=>[o(x,{status:a.data.status,class:"px-3 py-1"},{default:r(()=>[S(f(a.data.status),1)]),_:2},1032,["status"])]),_:2},[B()?{name:"cell-actions",fn:r(({row:a})=>[o(ae,{row:a.data,table:d.value},null,8,["row","table"])])}:void 0]),1032,["data","columns","loading"])])}}},Be={setup(O){const n=A(),d=H();let l=j(()=>n.isFetchingViewData);Z(d,()=>{d.params.id&&m()},{immediate:!0});async function m(){await n.fetchRecurringInvoice(d.params.id)}return(e,B)=>{const h=i("BaseHeading"),_=i("BaseDescriptionListItem"),E=i("BaseDescriptionList"),g=i("BaseCard");return u(),v(g,{class:"mt-10"},{default:r(()=>[o(h,null,{default:r(()=>[S(f(e.$t("customers.basic_info")),1)]),_:1}),o(E,{class:"mt-5"},{default:r(()=>{var x,s,a,y,V,k,D,$,C,F,T,N,L;return[o(_,{label:e.$t("recurring_invoices.starts_at"),"content-loading":t(l),value:(x=t(n).newRecurringInvoice)==null?void 0:x.formatted_starts_at},null,8,["label","content-loading","value"]),o(_,{label:e.$t("recurring_invoices.next_invoice_date"),"content-loading":t(l),value:(s=t(n).newRecurringInvoice)==null?void 0:s.formatted_next_invoice_at},null,8,["label","content-loading","value"]),((a=t(n).newRecurringInvoice)==null?void 0:a.limit_date)&&((y=t(n).newRecurringInvoice)==null?void 0:y.limit_by)!=="NONE"?(u(),v(_,{key:0,label:e.$t("recurring_invoices.limit_date"),"content-loading":t(l),value:(V=t(n).newRecurringInvoice)==null?void 0:V.limit_date},null,8,["label","content-loading","value"])):I("",!0),((k=t(n).newRecurringInvoice)==null?void 0:k.limit_date)&&((D=t(n).newRecurringInvoice)==null?void 0:D.limit_by)!=="NONE"?(u(),v(_,{key:1,label:e.$t("recurring_invoices.limit_by"),"content-loading":t(l),value:($=t(n).newRecurringInvoice)==null?void 0:$.limit_by},null,8,["label","content-loading","value"])):I("",!0),((C=t(n).newRecurringInvoice)==null?void 0:C.limit_count)?(u(),v(_,{key:2,label:e.$t("recurring_invoices.limit_count"),value:(F=t(n).newRecurringInvoice)==null?void 0:F.limit_count,"content-loading":t(l)},null,8,["label","value","content-loading"])):I("",!0),((T=t(n).newRecurringInvoice)==null?void 0:T.selectedFrequency)?(u(),v(_,{key:3,label:e.$t("recurring_invoices.frequency.title"),value:(L=(N=t(n).newRecurringInvoice)==null?void 0:N.selectedFrequency)==null?void 0:L.label,"content-loading":t(l)},null,8,["label","value","content-loading"])):I("",!0)]}),_:1}),o(h,{class:"mt-8"},{default:r(()=>[S(f(e.$t("invoices.title",2)),1)]),_:1}),o(Ie)]),_:1})}}},ke={setup(O){M();const n=A(),d=P();z(),U();const l=j(()=>{var e,B;return n.newRecurringInvoice?(B=(e=n.newRecurringInvoice)==null?void 0:e.customer)==null?void 0:B.name:""});function m(){return d.hasAbilities([R.DELETE_RECURRING_INVOICE,R.EDIT_RECURRING_INVOICE])}return(e,B)=>{const h=i("BasePageHeader"),_=i("BasePage");return u(),v(_,{class:"xl:pl-96"},{default:r(()=>[o(h,{title:t(l)},{actions:r(()=>[m()?(u(),v(oe,{key:0,row:t(n).newRecurringInvoice},null,8,["row"])):I("",!0)]),_:1},8,["title"]),o(ye),o(Be)]),_:1})}}};export{ke as default};
