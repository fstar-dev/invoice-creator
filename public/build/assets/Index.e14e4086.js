import{i as B,g as se,j as le,k as v,aS as oe,aT as ne,h as re,r as n,o as p,s as _,w as t,b as a,t as m,Z as F,al as T,y as l,z as g,v as f,x as i,A as U,a5 as ce,a0 as M}from"./vendor.e9042f2c.js";import{c as ue,i as me,k as ie,d as de,e as b}from"./main.d8ec3f25.js";import{_ as pe}from"./CustomerIndexDropdown.4b5eb246.js";import{A as _e}from"./AstronautIcon.e635ccba.js";const fe={class:"flex items-center justify-end space-x-5"},he={class:"relative table-container"},ye={class:"relative flex items-center justify-end h-5"},Ce={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},be={class:"absolute z-10 items-center left-6 top-2.5 select-none"},Be={class:"relative block"},ve={class:"text-xs text-gray-400"},$e={setup(ge){ue();const O=me(),c=ie(),k=de();let h=B(null),y=B(!1),I=B(!0);const{t:d}=se();let r=le({display_name:"",contact_name:"",phone:""});const P=v(()=>!c.totalCustomers&&!I.value),S=v({get:()=>c.selectedCustomers,set:s=>c.selectCustomer(s)}),V=v({get:()=>c.selectAllField,set:s=>c.setSelectAllState(s)}),z=v(()=>[{key:"status",thClass:"extra w-10 pr-0",sortable:!1,tdClass:"font-medium text-gray-900 pr-0"},{key:"name",label:d("customers.name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"phone",label:d("customers.phone")},{key:"due_amount",label:d("customers.amount_due")},{key:"created_at",label:d("items.added_on")},{key:"actions",tdClass:"text-right text-sm font-medium pl-0",thClass:"pl-0",sortable:!1}]);oe(r,()=>{W()},{debounce:500}),ne(()=>{c.selectAllField&&c.selectAllCustomers()});function $(){h.value.refresh()}function W(){$()}function Y(){return k.hasAbilities([b.DELETE_CUSTOMER,b.EDIT_CUSTOMER,b.VIEW_CUSTOMER])}async function L({page:s,filter:o,sort:C}){let x={display_name:r.display_name,contact_name:r.contact_name,phone:r.phone,orderByField:C.fieldName||"created_at",orderBy:C.order||"desc",page:s};I.value=!0;let u=await c.fetchCustomers(x);return I.value=!1,{data:u.data.data,pagination:{totalPages:u.data.meta.last_page,currentPage:s,totalCount:u.data.meta.total,limit:10}}}function R(){r.display_name="",r.contact_name="",r.phone=""}function G(){y.value&&R(),y.value=!y.value}let j=B(new Date);j.value=re(j).format("YYYY-MM-DD");function H(){O.openDialog({title:d("general.are_you_sure"),message:d("customers.confirm_delete",2),yesLabel:d("general.ok"),noLabel:d("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(s=>{s&&c.deleteMultipleCustomers().then(o=>{o.data&&$()})})}return(s,o)=>{const C=n("BaseBreadcrumbItem"),x=n("BaseBreadcrumb"),u=n("BaseIcon"),A=n("BaseButton"),X=n("BasePageHeader"),D=n("BaseInput"),E=n("BaseInputGroup"),Z=n("BaseFilterWrapper"),q=n("BaseEmptyPlaceholder"),J=n("BaseDropdownItem"),K=n("BaseDropdown"),N=n("BaseCheckbox"),Q=n("router-link"),ee=n("BaseFormatMoney"),te=n("BaseTable"),ae=n("BasePage");return p(),_(ae,null,{default:t(()=>[a(X,{title:s.$t("customers.title")},{actions:t(()=>[m("div",fe,[F(a(A,{variant:"primary-outline",onClick:G},{right:t(e=>[l(y)?(p(),_(u,{key:1,name:"XIcon",class:g(e.class)},null,8,["class"])):(p(),_(u,{key:0,name:"FilterIcon",class:g(e.class)},null,8,["class"]))]),default:t(()=>[f(i(s.$t("general.filter"))+" ",1)]),_:1},512),[[T,l(c).totalCustomers]]),l(k).hasAbilities(l(b).CREATE_CUSTOMER)?(p(),_(A,{key:0,onClick:o[0]||(o[0]=e=>s.$router.push("customers/create"))},{left:t(e=>[a(u,{name:"PlusIcon",class:g(e.class)},null,8,["class"])]),default:t(()=>[f(" "+i(s.$t("customers.new_customer")),1)]),_:1})):U("",!0)])]),default:t(()=>[a(x,null,{default:t(()=>[a(C,{title:s.$t("general.home"),to:"dashboard"},null,8,["title"]),a(C,{title:s.$tc("customers.customer",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),a(Z,{show:l(y),class:"mt-5",onClear:R},{default:t(()=>[a(E,{label:s.$t("customers.display_name"),class:"text-left"},{default:t(()=>[a(D,{modelValue:l(r).display_name,"onUpdate:modelValue":o[1]||(o[1]=e=>l(r).display_name=e),type:"text",name:"name",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),a(E,{label:s.$t("customers.contact_name"),class:"text-left"},{default:t(()=>[a(D,{modelValue:l(r).contact_name,"onUpdate:modelValue":o[2]||(o[2]=e=>l(r).contact_name=e),type:"text",name:"address_name",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),a(E,{label:s.$t("customers.phone"),class:"text-left"},{default:t(()=>[a(D,{modelValue:l(r).phone,"onUpdate:modelValue":o[3]||(o[3]=e=>l(r).phone=e),type:"text",name:"phone",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["show"]),F(a(q,{title:s.$t("customers.no_customers"),description:s.$t("customers.list_of_customers")},{actions:t(()=>[l(k).hasAbilities(l(b).CREATE_CUSTOMER)?(p(),_(A,{key:0,variant:"primary-outline",onClick:o[4]||(o[4]=e=>s.$router.push("/admin/customers/create"))},{left:t(e=>[a(u,{name:"PlusIcon",class:g(e.class)},null,8,["class"])]),default:t(()=>[f(" "+i(s.$t("customers.add_new_customer")),1)]),_:1})):U("",!0)]),default:t(()=>[a(_e,{class:"mt-5 mb-4"})]),_:1},8,["title","description"]),[[T,l(P)]]),F(m("div",he,[m("div",ye,[l(c).selectedCustomers.length?(p(),_(K,{key:0},{activator:t(()=>[m("span",Ce,[f(i(s.$t("general.actions"))+" ",1),a(u,{name:"ChevronDownIcon"})])]),default:t(()=>[a(J,{onClick:H},{default:t(()=>[a(u,{name:"TrashIcon",class:"mr-3 text-gray-600"}),f(" "+i(s.$t("general.delete")),1)]),_:1})]),_:1})):U("",!0)]),a(te,{ref:(e,w)=>{w.tableComponent=e,M(h)?h.value=e:h=e},class:"mt-3",data:L,columns:l(z)},ce({header:t(()=>[m("div",be,[a(N,{modelValue:l(V),"onUpdate:modelValue":o[5]||(o[5]=e=>M(V)?V.value=e:null),variant:"primary",onChange:l(c).selectAllCustomers},null,8,["modelValue","onChange"])])]),"cell-status":t(({row:e})=>[m("div",Be,[a(N,{id:e.data.id,modelValue:l(S),"onUpdate:modelValue":o[6]||(o[6]=w=>M(S)?S.value=w:null),value:e.data.id,variant:"primary"},null,8,["id","modelValue","value"])])]),"cell-name":t(({row:e})=>[a(Q,{to:{path:`customers/${e.data.id}/view`},class:"font-medium text-primary-500 flex flex-col"},{default:t(()=>[f(i(e.data.name)+" ",1),m("span",ve,i(e.data.contact_name?e.data.contact_name:""),1)]),_:2},1032,["to"])]),"cell-phone":t(({row:e})=>[m("span",null,i(e.data.phone?e.data.phone:"-"),1)]),"cell-due_amount":t(({row:e})=>[a(ee,{amount:e.data.due_amount||0,currency:e.data.currency},null,8,["amount","currency"])]),"cell-created_at":t(({row:e})=>[m("span",null,i(e.data.formatted_created_at),1)]),_:2},[Y()?{name:"cell-actions",fn:t(({row:e})=>[a(pe,{row:e.data,table:l(h),"load-data":$},null,8,["row","table"])])}:void 0]),1032,["columns"])],512),[[T,!l(P)]])]),_:1})}}};export{$e as default};
